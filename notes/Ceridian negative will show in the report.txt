SELECT
  S.PAY_TYPE,
  D.DRIVER_ID,
  D.NAME,
  DATE(S.STATEMENT_DATE) PAY_DATE,
  CASE WHEN NVL(M.USER1, '') = 'SUBSISTANCE' THEN P.TOTAL_PAY_AMT ELSE 0 END SUBSISTANCE,
  CASE WHEN NVL(P.PAY_CODE, '') NOT IN ('HOUR OVER') THEN P.HOURS ELSE 0 END AS "HOURS",
  CASE WHEN NVL(P.PAY_CODE, '') IN ('HOUR OVER') THEN P.HOURS ELSE 0 END AS "OVERTIME",
  CASE WHEN NVL(M.USER1, '') <> 'SUBSISTANCE' THEN P.TOTAL_PAY_AMT ELSE 0 END OTHER,
  P.TOTAL_PAY_AMT NET
FROM DR_STMT_REPORT S
JOIN DRIVERPAY P ON P.STATEMENT_ID = S.STATEMENT_ID
JOIN DRIVER D ON D.DRIVER_ID = P.DRIVER_ID
LEFT JOIN DRV_RULE_MILE M ON M.RULE_ID = P.RULE_ID
WHERE 1 = 1
  AND S.CHECK_AMT <> 0
  AND DATE(S.STATEMENT_DATE) = {?Statement Date}
UNION ALL

SELECT
  S.PAY_TYPE,
  D.DRIVER_ID,
  D.NAME,
  DATE(S.STATEMENT_DATE) PAY_DATE,
  0 SUBSISTANCE,
  0 AS "HOURS",
  0 "OVERTIME",
  0 OTHER,
  P.DED_AMT * -1 NET
FROM DR_STMT_REPORT S
JOIN DRIVERDEDUCTIONS P ON P.STATEMENT_ID = S.STATEMENT_ID
JOIN DRIVER D ON D.DRIVER_ID = P.DRIVER_ID
WHERE 1 = 1
  AND S.CHECK_AMT <> 0;
  AND DATE(S.STATEMENT_DATE) = {?Statement Date}